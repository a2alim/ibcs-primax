<div class="width-100">
    <!-- Header -->
    <app-form-header [title]="'headerTitle' | translate" [subTitle]="'headerSubTitle' | translate"></app-form-header>

    <div *ngIf="spinner" class="flex items-center justify-center">
        <div style="border-top-color:transparent; position: absolute;z-index: 9999;"
            class="absolute top-1/2 left-1/2 w-16 h-16 border-4 border-blue-400 border-dashed rounded-full animate-spin">
        </div>
    </div>


    <!-- Main Start -->
    <div class="body m-5">

        <div class="flex justify-end mt-3 mr-2">
            <button class="px-3 mr-2 previousBtn" mat-flat-button color="accent" type="button" (click)="previousTab()">
                <mat-icon *ngIf="previousIcon" class="mr-1">{{previousIcon}}</mat-icon>
                {{'Previous' | translate}}
            </button>

            <!--<button
                    class="px-3 mr-2 downloadBtn"
                    mat-flat-button
                    color="accent"
                    type="button">
                    <mat-icon *ngIf="downloadIcon" class="mr-1">{{downloadIcon}}</mat-icon>
                    {{'Download' | translate}}
                </button>-->

            <button [useExistingCss]="true" class="px-3 printBtn" mat-flat-button color="accent" printSectionId="print"
                ngxPrint type="button">
                <mat-icon *ngIf="printIcon" class="mr-1">{{printIcon}}</mat-icon>
                {{'Print' | translate}}
            </button>

        </div>
        <br />

        <!-- CARD ONE-->
        <div style="width: 100%;" fxLayout="row wrap" fxLayoutAlign="space-between center">
            <mat-label class="heading w-full">
                {{'ResearcherProposalMarks' | translate}}
            </mat-label>
        </div>

        <mat-card class="tab-color nikoshFont" id="print">

            <div>
                <div fxLayout="row wrap" fxLayoutAlign="space-between center">
                    <div fxFlex="50%" fxFlex.md="100%" fxFlex.sm="100%" fxFlex.xs="100%">
                        <div fxLayout="row wrap" fxLayoutAlign="space-between center">
                            <mat-label fxFlex="40%" fxFlex.md="30%" fxFlex.sm="40%" fxFlex.xs="100%">
                                <strong>{{'ResearchTitle' | translate}} :</strong>
                            </mat-label>
                            <p fxFlex="60%" fxFlex.md="70%" fxFlex.sm="60%" fxFlex.xs="100%">
                                {{this.proposal?.researchTitle}}</p>
                        </div>
                    </div>
                    <div fxFlex="50%" fxFlex.md="100%" fxFlex.sm="100%" fxFlex.xs="100%"></div>
                </div>
                <div fxLayout="row wrap" fxLayoutAlign="space-between center">
                    <div fxFlex="50%" fxFlex.md="100%" fxFlex.sm="100%" fxFlex.xs="100%">
                        <div fxLayout="row wrap" fxLayoutAlign="space-between center">
                            <mat-label fxFlex="40%" fxFlex.md="30%" fxFlex.sm="40%" fxFlex.xs="100%">
                                <strong>{{'ResearchCatType' | translate}} :</strong>
                            </mat-label>
                            <p fxFlex="60%" fxFlex.md="70%" fxFlex.sm="60%" fxFlex.xs="100%">
                                {{this.proposal?.researchCategoryType?.categoryName}}</p>
                        </div>
                    </div>

                    <div fxFlex="50%" fxFlex.md="100%" fxFlex.sm="100%" fxFlex.xs="100%"></div>
                </div>
                <div fxLayout="row wrap" fxLayoutAlign="space-between center">
                    <div fxFlex="50%" fxFlex.md="100%" fxFlex.sm="100%" fxFlex.xs="100%">
                        <div fxLayout="row wrap" fxLayoutAlign="space-between center">
                            <mat-label fxFlex="40%" fxFlex.md="30%" fxFlex.sm="40%" fxFlex.xs="100%">
                                <strong>{{'FiscalYear' | translate}} :</strong>
                            </mat-label>
                            <p fxFlex="60%" fxFlex.md="70%" fxFlex.sm="60%" fxFlex.xs="100%">
                                {{this.proposal?.fiscalYear?.fiscalYear | enToBn:langVal}}</p>
                        </div>
                    </div>

                    <div fxFlex="50%" fxFlex.md="100%" fxFlex.sm="100%" fxFlex.xs="100%"></div>
                </div>
            </div>

            <!-- Data Table -->
            <div class="flex flex-col bg-card shadow rounded overflow-x-auto sm:overflow-y-auto mt-4">
            <ng-container *ngIf="!isDraft">
                <div class="relative py-3 pl-4 pr-10 leading-normal text-green-700 bg-green-200  rounded-lg mt-2"
                    role="alert">
                    <div class="text-lg font-semibold text-green-600">{{'alreadySubmitted' | translate}}
                    </div>
                </div>
            </ng-container>
                <!--<mat-card>-->
                <div class="overflow-x-auto sm:overflow-y-auto" cdkScrollable>
                    <table style="width: 100%;">
                        <thead>
                            <tr>
                                <th rowspan="3" style="width: 5%;">{{'Sl' | translate}}</th>
                                <th rowspan="3" style="width: 25%;">{{'EvaluationField' | translate}}</th>
                                <th colspan="9" style="width: 60%;"> {{'Marks' | translate}}</th>
                                <th style="width: 10%;">{{'Total' | translate}}</th>
                            </tr>

                            <tr>
                                <th>{{'05' | enToBn:langVal}}</th>
                                <th colspan="2">{{'10' | enToBn:langVal}}</th>
                                <th colspan="4"> {{'20' | enToBn:langVal}}</th>
                                <th colspan="2">{{'15' | enToBn:langVal}}</th>
                                <th>{{'50' | enToBn:langVal}}</th>
                            </tr>

                            <tr>
                                <th>{{'1' | enToBn:langVal}} - {{'5' | enToBn:langVal}} </th>
                                <th colspan="2">
                                    {{'1' | enToBn:langVal}} - {{'10' | enToBn:langVal}}
                                </th>
                                <!-- <th>{{'5' | translate}}</th>                      -->
                                <th>{{'5' | translate}}</th>
                                <th>{{'5' | translate}}</th>
                                <th>{{'5' | translate}}</th>
                                <th>{{'5' | translate}}</th>
                                <th>{{'8' | enToBn:langVal}}</th>
                                <th>{{'7' | enToBn:langVal}}</th>
                                <th></th>
                                <!-- <th></th> -->
                            </tr>
                        </thead>
                        <tbody *ngFor="let m of marks; index as i;">
                            <tr>
                                <td rowspan="2" style="text-align: center;">{{i + 1 | enToBn:langVal}}</td>
                                <td rowspan="2">
                                    <ng-container *ngIf="i === 0;else second">
                                        {{'ResearchTopicSelection' | translate}}
                                    </ng-container>
                                    <ng-template #second>
                                        <ng-container *ngIf="i === 1;else third">
                                            {{'RelevanceOfContent' | translate}}
                                        </ng-container>
                                    </ng-template>
                                    <ng-template #third>
                                        <ng-container *ngIf="i === 2;else fourth">
                                            {{'ResearcherProposalStructure' | translate}}
                                        </ng-container>
                                    </ng-template>
                                    <ng-template #fourth>
                                        {{'PolicyFormulation' | translate}}
                                    </ng-template>
                                </td>
                                <td>
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 0 ? 'active' : ''"
                                        [(ngModel)]="m.mark.markOne" [ngModelOptions]="{standalone: true}"

                                        (keyup)="onValueChange($event, 'markOne', i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>5){this.value = 0}"
                                        >
                                </td>

                                <td *ngIf="i==1; else NotColSpan" colspan="2">
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 1 ? 'active' : ''"
                                        [disabled]="i == 1 ? false : true"
                                        [(ngModel)]="m.mark.markThree" [ngModelOptions]="{standalone: true}"
                                        (keyup)="onValueChange($event, 'markThree',  i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>10){this.value = 0}"
                                        style=" width: 102px !important; "
                                        >
                                </td>
                                <ng-template #NotColSpan>
                                    <td>
                                        <!-- <mat-icon class="mr-1">close</mat-icon> -->
                                        <input matInput type="number" class="field-size-right" required
                                            [ngClass]="i === 1 ? 'active' : ''"
                                            [disabled]="i == 1 ? false : true"
                                            [(ngModel)]="m.mark.markThree" [ngModelOptions]="{standalone: true}"
                                            (keyup)="onValueChange($event, 'markThree',  i)"
                                            oninput="if(this.value<0){this.value = this.value * -1} if(this.value>10){this.value = 0}">
                                    </td>
                                    <td>
                                        <!-- <mat-icon class="mr-1">close</mat-icon> -->
                                        <input matInput type="number" class="field-size-right" required
                                            [ngClass]="i === 1 ? 'active' : ''"
                                            [disabled]="i == 1 ? false : true"
                                            [(ngModel)]="m.mark.markFour" [ngModelOptions]="{standalone: true}"
                                            (keyup)="onValueChange($event, 'markFour',  i)"
                                            oninput="if(this.value<0){this.value = this.value * -1} if(this.value>5){this.value = 0}">
                                    </td>
                                </ng-template>

                                <td>
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 2 ? 'active' : ''"
                                        [disabled]="i == 2 ? false : true"
                                        [(ngModel)]="m.mark.markFive" [ngModelOptions]="{standalone: true}"
                                        (keyup)="onValueChange($event, 'markFive',  i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>5){this.value = 0}">
                                </td>
                                <td>
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 2 ? 'active' : ''"
                                        [disabled]="i == 2 ? false : true"
                                        [(ngModel)]="m.mark.markSix" [ngModelOptions]="{standalone: true}"
                                        (keyup)="onValueChange($event, 'markSix',  i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>5){this.value = 0}">
                                </td>
                                <td>
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 2 ? 'active' : ''"
                                        [disabled]="i == 2 ? false : true"
                                        [(ngModel)]="m.mark.markSeven" [ngModelOptions]="{standalone: true}"
                                        (keyup)="onValueChange($event, 'markSeven',  i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>5){this.value = 0}">
                                </td>
                                <td>
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 2 ? 'active' : ''"
                                        [disabled]="i == 2 ? false : true"
                                        [(ngModel)]="m.mark.markEight" [ngModelOptions]="{standalone: true}"
                                        (keyup)="onValueChange($event, 'markEight',  i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>5){this.value = 0}">
                                </td>
                                <td>
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 3 ? 'active' : ''"
                                        [disabled]="i == 3 ? false : true"
                                        [(ngModel)]="m.mark.markNine" [ngModelOptions]="{standalone: true}"
                                        (keyup)="onValueChange($event, 'markNine',  i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>8){this.value = 0}">
                                </td>
                                <td>
                                    <input matInput type="number" class="field-size-right" required
                                        [ngClass]="i === 3 ? 'active' : ''"
                                        [disabled]="i == 3 ? false : true"
                                        [(ngModel)]="m.mark.markTen" [ngModelOptions]="{standalone: true}"
                                        (keyup)="onValueChange($event, 'markTen',  i)"
                                        oninput="if(this.value<0){this.value = this.value * -1} if(this.value>7){this.value = 0}">
                                </td>
                                <td class="read-only text-center">{{m?.mark?.totalMarks | enToBn:langVal}}</td>
                            </tr>
                            <tr>
                                <td colspan="9" style="position: relative">
                                    <label class="AddComments" for="com{{i}}" [title]="'add_comment' | translate"><mat-icon *ngIf="addComment" class="mr-1">{{addComment}}</mat-icon></label>
                                    <input type="text" id="com{{i}}" [placeholder]="'add_comment' | translate" class="AddCommentsField"
                                    [(ngModel)]="m.mark.comments">
                                </td>
                                <td></td>
                            </tr>
                        </tbody>
                            <tr *ngIf="marks.length > 0">
                                <td style="text-align: center">{{marks.length + 1}}</td>
                                <td>{{'Total' | translate}}</td>
                                <td colspan="9"></td>
                                <td class="read-only text-center">{{total | enToBn:langVal}}</td>
                            </tr>
                    </table>
                </div>
                <!-- mat-paginator -->
            </div>

            <div class="flex justify-end mt-3 mr-2">
                <button [disabled]="(total > 50) || !isDraft || spinner" mat-flat-button style="background-color: green; color: #FFFFFF"
                    type="submit" (click)="onSubmit('draft')" color="primary"
                    class="px-3 mr-2 toggle-sidebar-folded saveBtn">
                    <mat-icon *ngIf="saveIcon" class="mr-1">{{saveIcon}}</mat-icon>
                    <span>{{ "Save" | translate }}</span>
                </button>

                <button mat-flat-button style="background-color: green; color: #FFFFFF" [disabled]="!isDraft || (total > 50) || spinner"
                        type="submit" (click)="openDialog('send')" color="primary"
                        class="px-3 mr-2 toggle-sidebar-folded saveBtn">
                    <mat-icon class="mr-1">send</mat-icon>
                    <span>{{ "Send" | translate }}</span>
                </button>
            </div>

            <!-- <div  class="flex justify-end mt-3 mr-2">
                <ng-container *ngIf="loginUserInfo.userType=='Rms_DO' || loginUserInfo.userType=='Rms_Evaluator'">
                    <button :disabled="saveDisable" *ngIf="marks.length > 0" mat-flat-button style="background-color: green; color: #FFFFFF"
                        type="submit" [disabled]="(total > 50) || allreadySaved" (click)="onSubmit()" color="primary"
                        class="px-3 mr-2 toggle-sidebar-folded saveBtn">
                        <mat-icon *ngIf="saveIcon" class="mr-1">{{saveIcon}}</mat-icon>
                        <span>{{ "Save" | translate }}</span>
                    </button>
                </ng-container>
            </div> -->

            <div [className]="langVal =='en' ? 'ml-10 enFont' : 'ml-10 bnFont'" [innerHtml]="('testing' | translate) | ngHtml"></div>
        </mat-card>
    </div>

    <!-- Main End -->
</div>
